# План створення проєкту з економетричними даними

## 1. Структура проєкту та налаштування середовища

- Створити віртуальне середовище Python 3.11+
- Створити `requirements.txt` з залежностями:
  - FastAPI, uvicorn (веб-сервер)
  - pandas, numpy (обробка даних)
  - faker, python-dateutil (генерація демо-даних)
  - plotly (інтерактивна візуалізація)
- Створити структуру каталогів:
  ```
  fastapi-economic-dashboard/
  ├── venv/
  ├── app/
  │   ├── main.py (FastAPI додаток)
  │   ├── data_generator.py (генератор демо-даних)
  │   ├── models.py (моделі даних)
  │   └── static/
  │       └── index.html (веб-інтерфейс)
  ├── data/ (згенеровані CSV файли)
  ├── requirements.txt
  └── README.md
  ```


## 2. Генератор демо-даних (`app/data_generator.py`)

Створити функції для генерації:

- **Продажі**: дата, продукт, кількість, ціна, виручка, регіон
- **Запаси**: продукт, залишки, мінімум, максимум
- **Собівартість і прибуток**: продукт, собівартість, ціна продажу, маржа
- **Часові ряди**: денні/місячні показники з трендами та сезонністю
- Експорт даних у CSV файли в `data/`

## 3. FastAPI REST API (`app/main.py`)

Створити ендпоінти:

### Основні дані
- `GET /` - головна сторінка з візуалізацією
- `GET /api/sales` - отримання даних про продажі (з фільтрами за датою)
- `GET /api/inventory` - дані про запаси
- `GET /api/profit` - дані про прибутковість
- `GET /api/trends` - часові ряди для графіків
- `GET /api/stats` - загальна статистика (KPI метрики)
- `GET /api/categories` - список категорій продуктів
- `GET /api/regions` - список регіонів продажу

### Робота з файлами
- `GET /api/files` - список файлів даних
- `GET /api/files/{filename}` - вміст CSV файлу з пагінацією
- `GET /api/files/{filename}/stats` - статистика CSV файлу
- `POST /api/regenerate` - регенерація всіх даних

### World Bank API інтеграція
- `GET /api/worldbank/countries` - список доступних країн
- `GET /api/worldbank/indicators-list` - список доступних показників
- `GET /api/worldbank/indicators` - економічні показники країн
- `GET /api/worldbank/normalized` - нормалізовані економічні дані
- `GET /api/worldbank/economic-health` - аналіз економічного здоров'я
- `GET /api/worldbank/comparison` - порівняння країн за показниками
- `GET /api/worldbank/trends/{country}` - аналіз трендів для країни
- `GET /api/worldbank/currency-rates` - курси валют для конвертації
- `POST /api/clear-cache` - очищення кешу World Bank API

### Криптовалютні дані
- `GET /api/crypto/markets` - ринкові дані топ криптовалют
- `GET /api/crypto/coins/{coin_id}/history` - історичні дані криптовалюти
- `GET /api/crypto/global` - глобальні метрики ринку криптовалют

### Системні
- `GET /api/server-logs` - серверні логи

## 4. Інтеграції з зовнішніми API

### World Bank API (`app/worldbank_client.py`)
- Інтеграція з API Світового банку для отримання економічних показників
- Підтримка основних показників: ВВП, інфляція, безробіття, експорт/імпорт
- Кешування даних для оптимізації продуктивності
- Нормалізація та конвертація валют
- Аналіз економічного здоров'я країн

### Криптовалютний API (`app/crypto_client.py`)
- Інтеграція з CoinGecko API для отримання даних про криптовалюти
- Ринкові дані топ криптовалют
- Історичні дані для графіків
- Глобальні метрики ринку криптовалют
- Кешування та fallback механізми

## 5. Інтерактивна веб-сторінка (`app/static/index.html`)

Створити дашборд з:

- **KPI панель**: загальна виручка, прибуток, маржа, кількість продажів
- **Графіки Plotly.js**:
  - Лінійний графік продажів у часі
  - Стовпчикова діаграма за продуктами
  - Кругова діаграма за регіонами
  - Графік рентабельності
- **Інтерактивність**: фільтри за датою, вибір періоду, масштабування
- Сучасний дизайн з Bootstrap CSS

## 6. Документація та запуск

- `README.md` з інструкціями:
  - Активація venv: `venv\Scripts\Activate.ps1`
  - Встановлення залежностей: `pip install -r requirements.txt`
  - Запуск сервера: `python run_server.py` (РЕКОМЕНДОВАНО)
  - Альтернативні скрипти: `python start_server_utf8.py` або `python start_simple.py`
  - Доступ: `http://localhost:8000`
- Автоматична генерація даних при першому запуску

### Правила запуску сервера:
- **Локальна розробка**: `python start_simple.py` (рекомендовано)
- **Деплой на Render**: `python run_server.py` (використовується в render.yaml)
- **НЕ запускати**: `python app/main.py` напряму (проблеми з імпортами)
- Скрипти забезпечують правильне кодування UTF-8 для Windows
- Використовувати PowerShell команди з `;` замість `&&`

### Правила роботи з даними:
- **Пріоритет джерел даних**: 1) Живі API дані, 2) Кешовані/збережені дані з попередніх запитів, 3) НІКОЛИ не використовувати демо/фейкові дані
- **При недоступності API**: використовувати localStorage кешовані дані або показувати відповідне повідомлення про помилку
- **Кешування**: автоматично зберігати дані з API в localStorage для використання при недоступності сервісу

## 7. Тестування та якість коду

### Тестові скрипти (`scripts/`)
- `test_worldbank_client.py` - тестування World Bank API клієнта
- `test_worldbank_endpoints.py` - тестування ендпоінтів World Bank API
- `run_wb_tests.ps1` - PowerShell скрипт для запуску тестів

### Контроль якості
- Валідація даних через Pydantic моделі
- Обробка помилок та fallback механізми
- Логування операцій для дебагу
- Кешування для оптимізації продуктивності

### Деплой та продакшен
- Конфігурація для Render.com (`render.yaml`, `render-gunicorn.yaml`)
- Gunicorn конфігурація (`gunicorn.conf.py`)
- Скрипти для різних середовищ (`run_server.py`, `render_start.py`)
- Автоматичний деплой через GitHub